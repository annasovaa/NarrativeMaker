<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Narrative Maker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100;400;700;900&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #0f172a;
      color: #e2e8f0;
    }
    .card {
      background-color: #1e293b;
      border: 1px solid #334155;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    }
    .pin-icon { transition: transform 0.1s ease-in-out; }
    .pin-icon:hover { transform: scale(1.1); }
    .locked .pin-icon { fill: #34d399; }
    .truncate-prevent { white-space: normal; word-break: break-word; }
  </style>
</head>
<body class="p-4 md:p-8 min-h-screen">
  <div class="max-w-6xl mx-auto">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ + –∫–Ω–æ–ø–∫–∏ -->
    <header class="text-center mb-10 space-y-3">
      <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-2">Narrative Maker</h1>
      <p class="text-xl text-slate-400">–†–∞–Ω–¥–æ–º–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–¥–µ–π –¥–ª—è –≤–∞—à–∏—Ö –∏—Å—Ç–æ—Ä–∏–π</p>

      <div class="flex flex-col md:flex-row gap-3 justify-center mt-6">
        <button id="generateAllButton"
                class="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition shadow-lg shadow-indigo-500/50">
          üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –í–°–ï
        </button>
        <button id="lockAllButton"
                class="px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-xl transition shadow-lg shadow-emerald-500/50">
          üß≤ –ó–∞–∫—Ä–µ–ø–∏—Ç—å –≤—Å–µ
        </button>
        <button id="unlockAllButton"
                class="px-6 py-3 bg-slate-600 hover:bg-slate-700 text-white font-bold rounded-xl transition shadow-lg shadow-slate-500/50">
          üßπ –°–Ω—è—Ç—å –≤—Å–µ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è
        </button>
      </div>
    </header>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–æ–ª–µ–π -->
    <main id="generator-container" class="grid grid-cols-1 lg:grid-cols-3 gap-6"></main>
  </div>

  <script>
    // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã)
    const DATA = {
      Tema: ["–§—ç–Ω—Ç–µ–∑–∏", "–ö–∏–±–µ—Ä–ø–∞–Ω–∫", "–ü–æ—Å—Ç–∞–ø–æ–∫–∞–ª–∏–ø—Å–∏—Å"],
      Nazvanie: ["–¢–µ–Ω—å –ü—Ä–æ—à–ª–æ–≥–æ", "–ó–≤–µ–∑–¥–Ω—ã–π –ö–æ–≤—á–µ–≥", "–ö–ª—é—á –°—É–¥—å–±—ã"],
      heroes: [
        "–≠–ª—å—Ñ–∏–π—Å–∫–∏–π –º–∞–≥: –º—É–¥—Ä—ã–π –∏ –º–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∞–≥.",
        "–¢–µ–º–Ω—ã–π —Ä—ã—Ü–∞—Ä—å: –≥–µ—Ä–æ–π —Å —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –ø—Ä–æ—à–ª—ã–º.",
        "–ö–∏–±–µ—Ä–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –¥–µ—Ç–µ–∫—Ç–∏–≤: –ø–æ–ª—É-—Ä–æ–±–æ—Ç, —Ä–∞—Å—Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏—è."
      ],
      Pol: ["–ú—É–∂—á–∏–Ω–∞", "–ñ–µ–Ω—â–∏–Ω–∞"],
      Vozrast: ["–¥–æ 20", "–¥–æ 30", "–¥–æ 40"]
    };

    const FIELDS_STRUCTURE = [
      {
        id: "general",
        title: "–û–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã",
        fields: [
          { id: "Tema", label: "–¢–µ–º–∞", type: "single" },
          { id: "Nazvanie", label: "–ù–∞–∑–≤–∞–Ω–∏–µ", type: "single" }
        ]
      },
      {
        id: "hero",
        title: "–ì–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π",
        fields: [
          { id: "heroes", label: "–¢–∏–ø –≥–µ—Ä–æ—è", type: "single" },
          { id: "Pol", label: "–ü–æ–ª", type: "single" },
          { id: "Vozrast", label: "–í–æ–∑—Ä–∞—Å—Ç", type: "single" }
        ]
      }
    ];

    let state = {};

    function getRandomValue(key) {
      const arr = DATA[key];
      if (!arr || !arr.length) return "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö";
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function generateField(fieldId, key, type) {
      if (state[fieldId]?.isLocked) return;
      state[fieldId] = {
        value: type === "single" ? getRandomValue(key) : "‚Äî",
        isLocked: state[fieldId]?.isLocked || false
      };
    }

    function toggleLock(fieldId) {
      if (!state[fieldId]) return;
      state[fieldId].isLocked = !state[fieldId].isLocked;
      render();
    }

    function generateAll() {
      FIELDS_STRUCTURE.forEach(s =>
        s.fields.forEach(f => generateField(f.id, f.id, f.type))
      );
      render();
    }

    function getPinIcon(fieldId, isLocked) {
      const title = isLocked ? "–û—Ç–∫—Ä–µ–ø–∏—Ç—å" : "–ó–∞–∫—Ä–µ–ø–∏—Ç—å";
      return `
        <button onclick="toggleLock('${fieldId}')" title="${title}"
          class="p-2 rounded-full hover:bg-slate-700">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
            viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            ${isLocked ? 'style="fill:#34d399;stroke:#34d399;"' : 'style="fill:none;stroke:#94a3b8;"'}>
            <path d="M14.43 1.93l-4.22 4.22c-.63.63-1.01 1.48-1.01 2.37V22l5-2 5 2V8.52c0-.89-.38-1.74-1.01-2.37l-4.22-4.22a2 2 0 0 0-2.83 0z"/>
          </svg>
        </button>`;
    }

    function render() {
      const container = document.getElementById("generator-container");
      container.innerHTML = FIELDS_STRUCTURE.map(section => `
        <div class="card p-6 rounded-2xl space-y-5">
          <h2 class="text-2xl font-bold text-white border-b border-indigo-500 pb-2">${section.title}</h2>
          ${section.fields.map(f => {
            const st = state[f.id] || { value: "‚Äî", isLocked: false };
            const lockClass = st.isLocked ? "border-emerald-400 text-emerald-300" : "border-slate-700 text-slate-200";
            return `
              <div>
                <label class="block text-sm text-slate-400">${f.label}</label>
                <div class="flex items-center justify-between card p-3 rounded-xl ${lockClass}">
                  <span class="text-base font-semibold flex-1 pr-4 truncate-prevent">${st.value}</span>
                  ${getPinIcon(f.id, st.isLocked)}
                </div>
              </div>`;
          }).join("")}
        </div>
      `).join("");
    }

    // --- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ---
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("generateAllButton").addEventListener("click", generateAll);

      document.getElementById("lockAllButton").addEventListener("click", () => {
        Object.keys(state).forEach(k => state[k].isLocked = true);
        render();
      });

      document.getElementById("unlockAllButton").addEventListener("click", () => {
        Object.keys(state).forEach(k => state[k].isLocked = false);
        render();
      });

      generateAll();
    });
  </script>
</body>
</html>
