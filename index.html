<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Narrative Maker: Генератор Нарративов</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Slate-900 */
            color: #e2e8f0; /* Slate-200 */
        }
        .card {
            background-color: #1e293b; /* Slate-800 */
            border: 1px solid #334155; /* Slate-700 */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        .pin-icon {
            transition: transform 0.1s ease-in-out;
        }
        .pin-icon:hover {
            transform: scale(1.1);
        }
        .locked .pin-icon {
            fill: #34d399; /* Emerald-400 */
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">

    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-2">Narrative Maker</h1>
            <p class="text-xl text-slate-400">Рандомный генератор идей для ваших историй</p>
            <div class="mt-6 flex flex-col md:flex-row justify-center gap-4">
                <button id="generateAllButton"
                        class="w-full md:w-auto px-8 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition shadow-lg shadow-indigo-500/50">
                    Сгенерировать ВСЕ
                </button>
                <button id="unlockAllButton"
                        class="w-full md:w-auto px-8 py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-xl transition shadow-lg shadow-red-500/50">
                    Снять все закрепления
                </button>
            </div>
        </header>

        <main id="generator-container" class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Dynamic content will be inserted here -->
        </main>
    </div>

    <script>
        // Глобальные переменные для данных
        const DATA = {
            Tema: ["Постапокалипсис", "Фэнтези", "Киберпанк", "Детектив", "Космическая опера", "Мифология", "Выживание", "Историческая", "Психологический триллер", "Приключения"],
            Nazvanie: ["Тень Прошлого", "Звездный Ковчег", "Код Восхода", "Безмолвный Город", "Ключи Судьбы", "Последний Рубеж", "Танец Дракона", "Железная Воля", "Цена Искупления", "Забытый Ритуал"],
            ZhanrIgry: ["Экшен (Action)", "Приключения (Adventure)", "Ролевые игры (RPG)", "Стратегии (Strategy)", "Симуляторы (Simulation)", "Спортивные игры (Sports)", "Гонки (Racing)", "Платформеры (Platformer)", "Хоррор (Horror)", "Файтинг (Fighting)", "Пазлы (Puzzle)", "Шутеры (Shooter)", "Музыкальные игры (Music)", "Рогалики (Roguelike)"],
            ZhanrIstorii: ["Фантастика", "Фэнтези", "Детектив", "Приключения", "Любовный роман", "Исторический роман", "Реалистическая проза", "Автобиография", "Научная литература", "Фольклор", "Юмор", "Психологический триллер", "Мемуары", "Эссе"],
            Risovka: ["Реализм", "Мультяшный (Cartoon)", "Пиксель-арт (Pixel Art)", "Ретро (Retro)", "Киберпанк (Cyberpunk)", "Фэнтези (Fantasy)", "Аниме (Anime)", "Клеточная анимация (Cel-Shaded)", "Готический (Gothic)"],

            // --- ПЕРСОНАЖИ ---
            heroes: ["Эльфийский маг: Мудрый и могущественный маг, стремящийся спасти свой мир от зла.",
    "Драконоборец: Храбрый воин, сражающийся с драконами, чтобы защитить свое королевство.",
    "Принцесса-воительница: Наследница трона, которая берет меч, чтобы защитить свой народ.",
    "Темный рыцарь: Герой с таинственным прошлым, стремящийся искупить свои грехи.",
    "Лесной дух: Защитник природы, обладающий магическими способностями.",
    "Космический исследователь: Храбрый астронавт, исследующий неизведанные планеты.",
    "Кибернетический детектив: Полу-робот, расследующий преступления в будущем.",
    "Генетический инженер: Ученый, создающий новые формы жизни.",
    "Пилот звездолета: Командир космического корабля, ведущий свою команду через галактику.",
    "Искусственный интеллект: Робот, стремящийся понять человеческую природу."],
            Pol: ["Мужчина", "Женщина", "Бесполый"],
            Vozrast: ["до 10", "до 20", "до 30", "до 40", "от 40 до 70", "от 70 до 100"],
            SotsStatus: ["Сирота", "Скиталец", "Король/Королева", "Простой рабочий", "Влиятельный политик", "Изгой", "Гений", "Медиум", "Бюрократ", "Миллионер"],
            Tragediya: ["Герой теряет силу.", "Принцесса узнает, что она дочь злого колдуна.", "Воин теряет товарищей.", "ИИ уничтожает человечество.", "Космонавт теряет связь с Землёй.", "Лучший друг — убийца.", "Любовь всей жизни умирает.", "Герой одержим демоном.", "Предан напарником.", "Теряет семью из-за войны."],
            PolozhKachestva: ["Храбрый", "Справедливый", "Умный", "Верный", "Оптимистичный", "Самоотверженный", "Харизматичный"],
            OtritsKachestva: ["Циничный", "Эгоистичный", "Наивный", "Горделивый", "Лживый", "Нерешительный", "Замкнутый"],
            ZhelaniePersonazha: ["Месть за прошлое", "Найти утерянный артефакт", "Свергнуть тирана", "Обрести семью", "Познать истину", "Вернуться домой", "Изменить прошлое", "Защитить любимого"],
            Professiya: ["Частный сыщик", "Пилот звездолета", "Эльфийский маг", "Драконоборец", "Агент спецслужб", "Хакер", "Бывший военный", "Автоугонщик", "Генетический инженер", "Комедийный актер"],

            // --- МЕСТО ДЕЙСТВИЯ (СЕТТИНГ) ---
            MestoPomeshcheniya: ["Детская комната", "Спальня", "Столовая", "Гостиная", "Ванная комната", "Кухня", "Гардеробная", "Коридор", "Прихожая", "Погреб"],
            Tsvet: ["Красный (тревога)", "Синий (покой)", "Желтый (опасность)", "Зеленый (природа)", "Серый (уныние)", "Пурпурный (тайна)"],
            Svet: ["Направленный", "Рассеянный", "Комбинированное", "Мерцающий", "Полное отсутствие"],
            Zvuk: ["Звуковые удары", "Шумы", "Музыкальные звуки (тоны)", "Глубокая тишина", "Скрип", "Шелест"],
            Zapah: ["Цветочные", "Восточные", "Свежие", "Древесные", "Острые", "Плесени", "Дыма"],
            Taktilnost: ["Нейтрально", "Больно", "Приятно", "Холодно", "Шершаво", "Гладко", "Липко"],
            Vkus: ["Горький", "Сладкий", "Кислый", "Соленый", "Острый", "Нейтральный"],
            Vysota: ["Низкая (давит)", "Средняя (комфорт)", "Высокая (пустота)", "Очень высокая"],
            Shirina: ["Узкая (теснота)", "Средняя (обычная)", "Широкая (простор)", "Огромная"],

            // --- КОНФЛИКТ ---
            KonfliktPersonazhey: ["Борьба за трон: Принцесса-воительница против узурпатора", "Восстание роботов", "Расследование убийства", "Любовный треугольник", "Революция", "Технологическая угроза", "Шпионаж", "Недоразумения"],
            KonfliktInteresov: ["Недопонимание целей", "Мораль против необходимости", "Личная выгода против долга", "Традиции против прогресса", "Закон против справедливости"]
        };

        // Структура полей для генерации и отображения
        const FIELDS_STRUCTURE = [
            { id: 'general', title: 'Общие параметры', fields: [
                { id: 'Tema', label: 'Тема', type: 'single' },
                { id: 'Nazvanie', label: 'Название', type: 'single' },
                { id: 'ZhanrIgry', label: 'Жанр игры', type: 'single' },
                { id: 'ZhanrIstorii', label: 'Жанр истории', type: 'single' },
                { id: 'Risovka', label: 'Рисовка', type: 'single' },
            ], colSpan: 1 },
            { id: 'mc', title: 'Главный герой', fields: [
                { id: 'Hero_MC', label: 'Герой', type: 'single', dataKey: 'heroes' }, // новое поле
                { id: 'Pol_MC', label: 'Пол', type: 'single', dataKey: 'Pol' },
                { id: 'Vozrast_MC', label: 'Возраст', type: 'single', dataKey: 'Vozrast' },
                { id: 'SotsStatus_MC', label: 'Социальный статус', type: 'single', dataKey: 'SotsStatus' },
                { id: 'Tragediya_MC', label: 'Трагедия', type: 'single', dataKey: 'Tragediya' },
                { id: 'PolozhKachestva_MC', label: 'Положительные качества', type: 'single
